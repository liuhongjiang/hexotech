<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>基于SVM的手写数字识别 | Andrew&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="前面两篇blog介绍了支持向量机SVM和SMO算法，这一篇就讲讲SVM的一个简单实际应用：使用svm实现一个简单的数字手写识别软件。首先要解决如何使用svm进行多类分类。
svm与多类分类1
svm是一个二类的分类器，即它只回答属于正类还是负类的问题。而现实中要解决的问题，往往是多类的问题，比如文本分类，比如数字识别。如何由两类分类器得到多类分类器, 一般有三种方法：
一对多（一对其余）">
<meta property="og:type" content="article">
<meta property="og:title" content="基于SVM的手写数字识别">
<meta property="og:url" content="http://liuhongjiang.github.io/2012/12/29/svm-ocr/index.html">
<meta property="og:site_name" content="Andrew's Blog">
<meta property="og:description" content="前面两篇blog介绍了支持向量机SVM和SMO算法，这一篇就讲讲SVM的一个简单实际应用：使用svm实现一个简单的数字手写识别软件。首先要解决如何使用svm进行多类分类。
svm与多类分类1
svm是一个二类的分类器，即它只回答属于正类还是负类的问题。而现实中要解决的问题，往往是多类的问题，比如文本分类，比如数字识别。如何由两类分类器得到多类分类器, 一般有三种方法：
一对多（一对其余）">
<meta property="og:image" content="http://liuhongjiang.github.io/hexotech/images/blogimages/2012/svm-ocr/dag-svm.jpg">
<meta property="og:image" content="http://liuhongjiang.github.io/hexotech/images/blogimages/2012/svm-ocr/data-sample.jpg">
<meta property="og:image" content="http://liuhongjiang.github.io/hexotech/images/blogimages/2012/svm-ocr/ocr_test_output.jpg">
<meta property="og:updated_time" content="2015-08-12T07:21:01.105Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基于SVM的手写数字识别">
<meta name="twitter:description" content="前面两篇blog介绍了支持向量机SVM和SMO算法，这一篇就讲讲SVM的一个简单实际应用：使用svm实现一个简单的数字手写识别软件。首先要解决如何使用svm进行多类分类。
svm与多类分类1
svm是一个二类的分类器，即它只回答属于正类还是负类的问题。而现实中要解决的问题，往往是多类的问题，比如文本分类，比如数字识别。如何由两类分类器得到多类分类器, 一般有三种方法：
一对多（一对其余）">
  
    <link rel="alternative" href="/atom.xml" title="Andrew&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/hexotech/images/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/hexotech/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/hexotech/" id="logo">Andrew&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/hexotech/">Home</a>
        
          <a class="main-nav-link" href="/hexotech/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://liuhongjiang.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-svm-ocr" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/hexotech/2012/12/29/svm-ocr/" class="article-date">
  <time datetime="2012-12-29T14:37:00.000Z" itemprop="datePublished">2012-12-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexotech/categories/Machine-nbsp-Learning/">Machine&nbsp;Learning</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      基于SVM的手写数字识别
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前面两篇blog介绍了<a href="/2012/12/26/2012-12-26-svm/">支持向量机SVM</a>和<a href="/2012/12/28/2012-12-28-svm-smo/">SMO算法</a>，这一篇就讲讲SVM的一个简单实际应用：使用svm实现一个简单的数字手写识别软件。首先要解决如何使用svm进行多类分类。</p>
<h2 id="svm与多类分类1">svm与多类分类<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></h2>
<p>svm是一个二类的分类器，即它只回答属于正类还是负类的问题。而现实中要解决的问题，往往是多类的问题，比如文本分类，比如数字识别。如何由两类分类器得到多类分类器, 一般有三种方法：</p>
<h3 id="一对多一对其余">一对多（一对其余）</h3>
<p>比如我们有5个类别，第一次就把类别1的样本定为正样本，其余2，3，4，5的样本合起来定为负样本，这样得到一个两类分类器。 通过类似的方法构造类别2、3、4、5的分类器，对于测试数据，每一个分类器都过一次，在那个分类器中，被判定为正，那么就认识它属于那个分类。 但有两个问题还没有解决：一是被多个分类器判定为正，二是被所有分类器判定为负。第一种情况，可以简单地选择第一个被判定为正的分类，对二种情况，可以视为分类失败了。另外一个问题是，“其余”的那一类样本数总是要数倍于正类（因为它是除正类以外其他类别的样本之和嘛），这就人为的造成了的<a href="http://www.blogjava.net/zhenandaci/archive/2009/03/17/260315.html" target="_blank" rel="external">“数据集偏斜”</a>问题。</p>
<a id="more"></a>
<h3 id="一对一">一对一</h3>
<p>这种方法需要构造n*(n-1)/2个分类器。简单地可以理解为所有分类1v1进行pk,具体做法，还是每次选一个类的样本作正类样本，而负类样本则变成只选一个类，(例如构造一个1 pk 2的分类器，它的正样本为1的分类，负样本为2的分类）这就避免了偏斜。 因此过程就是算出这样一些分类器，第一个只回答“是第1类还是第2类”，第二个只回答“是第1类还是第3类”，第三个只回答“是第1类还是第4类”，如此下去，所以一共有5*(5-1)/2=10个分类器。</p>
<p>虽然分类器的数目多了，但是在训练阶段（也就是算出这些分类器的分类平面时）所用的总时间却比“一类对其余”方法少很多，在真正用来分类的时候，把一个测试数据扔给所有分类器，第一个分类器会投票说它是“1”或者“2”，第二个会说它是“1”或者“3”，让每一个都投上自己的一票，最后统计票数，如果类别“1”得票最多，就判这篇文章属于第1类。但这有个问题，分类器的数量是类别数量的平方,例如，类别数如果是1000，要调用的分类器数目会上升至约500,000个（类别数的平方量级）。</p>
<h3 id="dag-svm">DAG SVM</h3>
<p>这种方法是构造一个DAG SVM，（有向无环的svm)。 还是像一对一方法那样来训练，只是在对一篇文章进行分类之前，先按照下面图的样子来组织分类器这样在分类时,我们就可以先问分类器“1对5”（意思是它能够回答“是第1类还是第5类”），如果它回答5，我们就往左走，再问“2对5”这个分类器，如果它还说是“5”，我们就继续往左走，这样一直问下去，就可以得到分类结果。</p>
<img src="/hexotech/images/blogimages/2012/svm-ocr/dag-svm.jpg" class="center">
<p>好处在哪？我们其实只调用了4个分类器（如果类别数是k，则只调用k-1个），分类速度飞快，且没有分类重叠和不可分类现象！缺点在哪？假如最一开始的分类器回答错误（明明是类别1的文章，它说成了5），那么后面的分类器是无论如何也无法纠正它的错误的（因为后面的分类器压根没有出现“1”这个类别标签），其实对下面每一层的分类器都存在这种错误向下累积的现象。 不过不要被DAG方法的错误累积吓倒，错误累积在一对其余和一对一方法中也都存在，DAG方法好于它们的地方就在于，累积的上限，不管是大是小，总是有定论的，有理论证明。而一对其余和一对一方法中，尽管每一个两类分类器的泛化误差限是知道的，但是合起来做多类分类的时候，误差上界是多少，没人知道，这意味着准确率低到0也是有可能的，这多让人郁闷。</p>
<p>而且现在DAG方法根节点的选取（也就是如何选第一个参与分类的分类器），也有一些方法可以改善整体效果，我们总希望根节点少犯错误为好，因此参与第一次分类的两个类别，最好是差别特别特别大，大到以至于不太可能把他们分错；或者我们就总取在两类分类中正确率最高的那个分类器作根节点，或者我们让两类分类器在分类的时候，不光输出类别的标签，还输出一个类似“置信度”的东东，当它对自己的结果不太自信的时候，我们就不光按照它的输出走，把它旁边的那条路也走一走，等等。</p>
<h2 id="高斯核函数">高斯核函数</h2>
<p>这个手写识别svm的核函数采用了高斯核函数。高斯核函数的公式如下</p>
<p><span class="math display">\[
K({x_i},{x_j})=e^{- \frac { {\left \| {x_i - x_j} \right \| }^2}{2\delta ^2}}
\]</span></p>
<p>其中的径向基函数的宽度<span class="math inline">\(\delta\)</span>对分类器的性能比较敏感，对取不同的<span class="math inline">\(\delta\)</span>时，高斯核支持向量机的性能进行分析，若$0 $ ，则所有的训练样本点都是支持向量，且它们全部能被正确的分类，但容易出现“过学习”的现象，推广能力较差，对测试样本的错误识别率较高；若<span class="math inline">\(\delta \to \infty\)</span> ，高斯核支持向量机对所有样本一视同仁，推广能力或对测试样本的正确判别能力为零，即它把所有样本点判为同一类。 实际上，当<span class="math inline">\(\delta\)</span>取比训练样本点之间的平均距离小得多时，就能达到$0 <span class="math inline">\(的效果；当\)</span><span class="math inline">\(取比训练样本点之间的平均距离大得多时，就能达到\)</span><span class="math inline">\(的效果。 在确定高斯径向基函数的宽度\)</span><span class="math inline">\(时，最基本的方法是对\)</span><span class="math inline">\(取不同的值，然后分别采用支持向量机方法进行训练，选择最小分类错误率的一组\)</span>$参数。比较典型的方法有梯度下降法与交叉验证法。<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<h2 id="数据">数据</h2>
<p>我实现的这个数学手写识别的数据是<a href="http://www.manning.com/pharrington/" target="_blank" rel="external">“Machine Learning in Action”</a>的第二章的数据，可以下载这本的<a href="http://www.manning.com/pharrington/MLiA_SourceCode.zip" target="_blank" rel="external">source code</a>获得。解压后的路径为machinelearninginaction/Ch02/digits.zip。</p>
<p>将digits.zip解压后就可以得到训练数据和测试数据。这些都是原始数据经过处理后的数据，是一个各个文件，一个文件是一个手写数据，文件名像这样“0_52.txt”，签名的0表示这个手写数据对应的数字，后面的数字52，是0这一类手写数据的文件编号。书写数据如下图所示，是一个32*32的黑白位图。</p>
<img src="/hexotech/images/blogimages/2012/svm-ocr/data-sample.jpg" class="center">
<p>在处理手写数据时，例子中是将它们存放到一个32*32的矩阵中，也可以存放到一个有1024的一维数组。计算高斯核函数的${\| {x_i} - {x_j} \|} ^2 $如下，以一维数组为例：</p>
<p><span class="math display">\[
\begin{array}{l}
{\left \| {x_i} - {x_j} \right \|}^2 = \sum\limits_{k=0}^{1023}{ {(x_i^k - x_j^k)}^2} \\
x_i=(x_i^0,x_i^1,\cdot \cdot \cdot,x_i^{1023})
\end{array}
\]</span></p>
<h2 id="实现">实现</h2>
<p>我实现了一个简单的基于svm的数字手写识别的python脚本，多类分类的模型采用的是一对多（一对其余）的方式，所以一共构造了10个分类器，分别对应0到9。算法采用的是前一篇blog讲的<a href="/blog/2012/12/28/svm-smo/">SMO</a>，算法的实现也基本是一样的。下面是具体的代码，可以下载<a href="https://github.com/liuhongjiang/blog_projects/tree/master/svm_ocr" target="_blank" rel="external">github上的代码和数据</a>。</p>
<figure class="highlight python"><figcaption><span>基于svm的数字手写识别</span><a href="/hexotech/code/2012/svm-ocr/svm_ocr.py">view raw</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### ###</span></span><br><span class="line"><span class="comment"># handwriting numbers OCR based on svm.</span></span><br><span class="line"><span class="comment"># data from "Machine Learning in Action" chapter 02.</span></span><br><span class="line"><span class="comment"># 基于SVM的手写数字的识别程序</span></span><br><span class="line"><span class="comment"># 数据：采用了《Machine Learning in Action》第二章的数据</span></span><br><span class="line"><span class="comment">### ###</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">model</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.a = []</span><br><span class="line">        self.b = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GV</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.samples = []        <span class="comment"># 样本数据</span></span><br><span class="line">        self.tests = []          <span class="comment"># 测试数据</span></span><br><span class="line">        self.models = []         <span class="comment"># 训练的模型</span></span><br><span class="line">        self.diff_dict = []      <span class="comment"># 用于缓存预测知与真实y之差Ei</span></span><br><span class="line">        self.cur_mno = <span class="number">0</span>         <span class="comment"># 当前正使用或训练的模型</span></span><br><span class="line">        self.cache_kernel = []   <span class="comment"># 缓存kernel函数的计算结果</span></span><br><span class="line">        self.use_linear = <span class="keyword">False</span>  <span class="comment"># 是否使用线性核函数</span></span><br><span class="line">        self.RBF_dlt = <span class="number">10</span>        <span class="comment"># 径向基函数的宽度</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_models</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">10</span>):</span><br><span class="line">            m = model()</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(self.samples)):</span><br><span class="line">                m.a.append(<span class="number">0</span>)</span><br><span class="line">            self.models.append(m)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_cache_kernel</span><span class="params">(self)</span>:</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> mi <span class="keyword">in</span> self.samples: </span><br><span class="line">            <span class="keyword">print</span> i</span><br><span class="line">            self.cache_kernel.append([])</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> mj <span class="keyword">in</span> self.samples:</span><br><span class="line">                <span class="keyword">if</span> i &gt; j:</span><br><span class="line">                    self.cache_kernel[i].append(self.cache_kernel[j][i])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.cache_kernel[i].append(kernel(mi,mj))</span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">image</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.data = []</span><br><span class="line">        self.num = <span class="number">0</span></span><br><span class="line">        self.label = []</span><br><span class="line">        self.fn = <span class="string">""</span></span><br><span class="line">       </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printself</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"data"</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> self.data:</span><br><span class="line">            <span class="keyword">print</span> line</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"num"</span>, self.num</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"label"</span>, self.label[gv.cur_mno]</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"fn"</span>, self.fn </span><br><span class="line"></span><br><span class="line"><span class="comment"># global variables</span></span><br><span class="line">gv = GV()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_image</span><span class="params">(path)</span>:</span></span><br><span class="line">    img_map = []</span><br><span class="line">    fp = open(path, <span class="string">"r"</span>) </span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> fp:</span><br><span class="line">        line = line[:-<span class="number">2</span>]</span><br><span class="line">        img_map.append(line)</span><br><span class="line">    <span class="keyword">return</span> img_map</span><br><span class="line"></span><br><span class="line"><span class="comment"># load samples and tests</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loaddata</span><span class="params">(dirpath, col)</span>:</span></span><br><span class="line">    files = os.listdir(dirpath)</span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">        img = image()</span><br><span class="line">        img.data = parse_image(dirpath + file)</span><br><span class="line">        img.num = int(file[<span class="number">0</span>])</span><br><span class="line">        img.fn = file</span><br><span class="line">        col.append(img)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kernel</span><span class="params">(mj, mi)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> gv.use_linear == <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">return</span> kernel_linear(mj,mi)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> kernel_RBF(mj,mi)</span><br><span class="line"></span><br><span class="line"><span class="comment">######</span></span><br><span class="line"><span class="comment"># 高斯核函数</span></span><br><span class="line"><span class="comment">######</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kernel_RBF</span><span class="params">(mj, mi)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> mj == mi:</span><br><span class="line">        <span class="keyword">return</span> math.exp(<span class="number">0</span>)</span><br><span class="line">    dlt = gv.RBF_dlt</span><br><span class="line">    ret = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(mj.data)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(mj.data[i])):</span><br><span class="line">            ret += math.pow(int(mj.data[i][j]) - int(mi.data[i][j]), <span class="number">2</span>)</span><br><span class="line">    ret = math.exp(-ret/(<span class="number">2</span>*dlt*dlt))</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="comment">######</span></span><br><span class="line"><span class="comment"># 线性</span></span><br><span class="line"><span class="comment">######</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kernel_linear</span><span class="params">(mj, mi)</span>:</span></span><br><span class="line">    ret = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(mj.data)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(mj.data[i])):</span><br><span class="line">            ret += int(mj.data[i][j]) * int(mi.data[i][j])</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># g(x)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(m)</span>:</span></span><br><span class="line">    pred = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(gv.samples)):</span><br><span class="line">        <span class="keyword">if</span> gv.models[gv.cur_mno].a[j] != <span class="number">0</span>:</span><br><span class="line">            pred += gv.models[gv.cur_mno].a[j] * gv.samples[j].label[gv.cur_mno] * kernel(gv.samples[j],m)</span><br><span class="line">    pred += gv.models[gv.cur_mno].b </span><br><span class="line">    <span class="keyword">return</span> pred</span><br><span class="line"></span><br><span class="line"><span class="comment"># the same as predict(m), only with different parmaters</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict_train</span><span class="params">(i)</span>:</span></span><br><span class="line">    pred = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(gv.samples)):</span><br><span class="line">        <span class="keyword">if</span> gv.models[gv.cur_mno].a[j] != <span class="number">0</span>:</span><br><span class="line">            pred += gv.models[gv.cur_mno].a[j] * gv.samples[j].label[gv.cur_mno] * gv.cache_kernel[j][i]</span><br><span class="line">    pred += gv.models[gv.cur_mno].b </span><br><span class="line">    <span class="keyword">return</span> pred</span><br><span class="line"></span><br><span class="line"><span class="comment"># 决策函数对xi的预测值和真实值之差</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict_diff_real</span><span class="params">(i)</span>:</span></span><br><span class="line">    diff = predict_train(i)</span><br><span class="line">    diff -= gv.samples[i].label[gv.cur_mno]</span><br><span class="line">    <span class="keyword">return</span> diff</span><br><span class="line"></span><br><span class="line"><span class="comment"># 优化计算Ei</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict_diff_real_optimized</span><span class="params">(idx, i, new_ai, j, new_aj, new_b)</span>:</span></span><br><span class="line">    diff = (new_ai - gv.models[gv.cur_mno].a[i])* gv.samples[i].label[gv.cur_mno] * gv.cache_kernel[i][idx]</span><br><span class="line">    diff += (new_aj - gv.models[gv.cur_mno].a[j])* gv.samples[j].label[gv.cur_mno] * gv.cache_kernel[j][idx]</span><br><span class="line">    diff += new_b - gv.models[gv.cur_mno].b</span><br><span class="line">    diff += gv.diff_dict[idx]</span><br><span class="line">    <span class="keyword">return</span> diff</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_predict_diff_real_dict</span><span class="params">()</span>:</span></span><br><span class="line">    gv.diff_dict = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(gv.samples)):</span><br><span class="line">        gv.diff_dict.append(predict_diff_real(i))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_diff_dict</span><span class="params">(i, new_ai, j, new_bj, new_b)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> range(len(gv.samples)):</span><br><span class="line">        <span class="comment"># 原来的函数</span></span><br><span class="line">        <span class="comment"># gv.diff_dict[idx] = predict_diff_real(idx)</span></span><br><span class="line">        <span class="comment"># 有优化后的</span></span><br><span class="line">        gv.diff_dict[idx] = predict_diff_real_optimized(idx, i, new_ai, j, new_bj, new_b)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_samples_label</span><span class="params">(num)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> gv.samples:</span><br><span class="line">        <span class="keyword">if</span> img.num == num:</span><br><span class="line">            img.label.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img.label.append(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">######</span></span><br><span class="line"><span class="comment">#  svmocr train</span></span><br><span class="line"><span class="comment">#  基于算法SMO</span></span><br><span class="line"><span class="comment">#  T: tolerance 误差容忍度(精度)</span></span><br><span class="line"><span class="comment">#  times: 迭代次数</span></span><br><span class="line"><span class="comment">#  C: 惩罚系数</span></span><br><span class="line"><span class="comment">#  Mno: 模型序号0到9</span></span><br><span class="line"><span class="comment">#  step: aj移动的最小步长</span></span><br><span class="line"><span class="comment">######</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SVM_SMO_train</span><span class="params">(T, times, C, Mno, step)</span>:</span></span><br><span class="line">    time = <span class="number">0</span></span><br><span class="line">    gv.cur_mno = Mno</span><br><span class="line">    update_samples_label(Mno)</span><br><span class="line">    init_predict_diff_real_dict()</span><br><span class="line">    updated = <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">while</span> time &lt; times <span class="keyword">and</span> updated:</span><br><span class="line">        updated = <span class="keyword">False</span></span><br><span class="line">        time += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(gv.samples)):</span><br><span class="line">            ai = gv.models[gv.cur_mno].a[i]</span><br><span class="line">            Ei = gv.diff_dict[i]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># agaist the KKT</span></span><br><span class="line">            <span class="keyword">if</span> (gv.samples[i].label[gv.cur_mno] * Ei &lt; -T <span class="keyword">and</span> ai &lt; C) <span class="keyword">or</span> (gv.samples[i].label[gv.cur_mno] * Ei &gt; T <span class="keyword">and</span> ai &gt; <span class="number">0</span>):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> range(len(gv.samples)):</span><br><span class="line">                    <span class="keyword">if</span> j == i: <span class="keyword">continue</span></span><br><span class="line">                    kii = gv.cache_kernel[i][i]</span><br><span class="line">                    kjj = gv.cache_kernel[j][j]</span><br><span class="line">                    kji = kij = gv.cache_kernel[i][j] </span><br><span class="line">                    eta = kii + kjj - <span class="number">2</span> * kij </span><br><span class="line">                    <span class="keyword">if</span> eta &lt;= <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">                    new_aj = gv.models[gv.cur_mno].a[j] + gv.samples[j].label[gv.cur_mno] * (gv.diff_dict[i] - gv.diff_dict[j]) / eta <span class="comment"># f 7.106</span></span><br><span class="line">                    L = <span class="number">0.0</span></span><br><span class="line">                    H = <span class="number">0.0</span></span><br><span class="line">                    a1_old = gv.models[gv.cur_mno].a[i]</span><br><span class="line">                    a2_old = gv.models[gv.cur_mno].a[j]</span><br><span class="line">                    <span class="keyword">if</span> gv.samples[i].label[gv.cur_mno] == gv.samples[j].label[gv.cur_mno]:</span><br><span class="line">                        L = max(<span class="number">0</span>, a2_old + a1_old - C)</span><br><span class="line">                        H = min(C, a2_old + a1_old)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        L = max(<span class="number">0</span>, a2_old - a1_old)</span><br><span class="line">                        H = min(C, C + a2_old - a1_old)</span><br><span class="line">                    <span class="keyword">if</span> new_aj &gt; H:</span><br><span class="line">                        new_aj = H</span><br><span class="line">                    <span class="keyword">if</span> new_aj &lt; L:</span><br><span class="line">                        new_aj = L</span><br><span class="line">                    <span class="keyword">if</span> abs(a2_old - new_aj) &lt; step:</span><br><span class="line">                        <span class="keyword">print</span> <span class="string">"j = %d, is not moving enough"</span> % j</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                    new_ai = a1_old + gv.samples[i].label[gv.cur_mno] * gv.samples[j].label[gv.cur_mno] * (a2_old - new_aj) <span class="comment"># f 7.109 </span></span><br><span class="line">                    new_b1 = gv.models[gv.cur_mno].b - gv.diff_dict[i] - gv.samples[i].label[gv.cur_mno] * kii * (new_ai - a1_old) - gv.samples[j].label[gv.cur_mno] * kji * (new_aj - a2_old) <span class="comment"># f7.115</span></span><br><span class="line">                    new_b2 = gv.models[gv.cur_mno].b - gv.diff_dict[j] - gv.samples[i].label[gv.cur_mno]*kji*(new_ai - a1_old) - gv.samples[j].label[gv.cur_mno]*kjj*(new_aj-a2_old)    <span class="comment"># f7.116</span></span><br><span class="line">                    <span class="keyword">if</span> new_ai &gt; <span class="number">0</span> <span class="keyword">and</span> new_ai &lt; C: new_b = new_b1</span><br><span class="line">                    <span class="keyword">elif</span> new_aj &gt; <span class="number">0</span> <span class="keyword">and</span> new_aj &lt; C: new_b = new_b2</span><br><span class="line">                    <span class="keyword">else</span>: new_b = (new_b1 + new_b2) / <span class="number">2.0</span></span><br><span class="line"></span><br><span class="line">                    update_diff_dict(i, new_ai, j, new_aj, new_b)</span><br><span class="line">                    gv.models[gv.cur_mno].a[i] = new_ai</span><br><span class="line">                    gv.models[gv.cur_mno].a[j] = new_aj</span><br><span class="line">                    gv.models[gv.cur_mno].b = new_b</span><br><span class="line">                    updated = <span class="keyword">True</span></span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"iterate: %d, changepair: i: %d, j:%d"</span> %(time, i, j)</span><br><span class="line">                    <span class="comment">#break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">    recog = <span class="number">0</span></span><br><span class="line">    recog_correct = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> gv.tests: </span><br><span class="line">        <span class="keyword">print</span> <span class="string">"test for"</span>, img.fn</span><br><span class="line">        <span class="keyword">for</span> mno <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">            gv.cur_mno = mno</span><br><span class="line">            <span class="keyword">if</span> predict(img) &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">print</span> mno</span><br><span class="line">                <span class="keyword">print</span> img.fn</span><br><span class="line">                recog += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> mno == int(img.fn[<span class="number">0</span>]):</span><br><span class="line">                    recog_correct += <span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"recog:"</span>, recog</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"recog_correct:"</span>, recog_correct</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"total:"</span>, len(gv.tests)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_models</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        fn = open(<span class="string">"models/"</span> + str(i) + <span class="string">"_a.model"</span>, <span class="string">"w"</span>)</span><br><span class="line">        <span class="keyword">for</span> ai <span class="keyword">in</span> gv.models[i].a:</span><br><span class="line">            fn.write(str(ai))</span><br><span class="line">            fn.write(<span class="string">'\n'</span>)</span><br><span class="line">        fn.close()</span><br><span class="line">        fn = open(<span class="string">"models/"</span> + str(i) + <span class="string">"_b.model"</span>, <span class="string">"w"</span>)</span><br><span class="line">        fn.write(str(gv.models[i].b))</span><br><span class="line">        fn.close()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_models</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        fn = open(<span class="string">"models/"</span> + str(i) + <span class="string">"_a.model"</span>, <span class="string">"r"</span>)</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> fn:</span><br><span class="line">            gv.models[i].a[j] = float(line)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        fn.close()</span><br><span class="line">        fn = open(<span class="string">"models/"</span> + str(i) + <span class="string">"_b.model"</span>, <span class="string">"r"</span>)</span><br><span class="line">        gv.models[i].b = float(fn.readline())</span><br><span class="line">        fn.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    training = <span class="keyword">True</span></span><br><span class="line">    loaddata(<span class="string">"trainingDigits/"</span>, gv.samples)</span><br><span class="line">    loaddata(<span class="string">"testDigits/"</span>, gv.tests)    </span><br><span class="line">    <span class="keyword">print</span> len(gv.samples)</span><br><span class="line">    <span class="keyword">print</span> len(gv.tests)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> training == <span class="keyword">True</span>:</span><br><span class="line">        gv.init_cache_kernel()</span><br><span class="line">    gv.init_models()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"init_models done"</span></span><br><span class="line"></span><br><span class="line">    T = <span class="number">0.0001</span></span><br><span class="line">    C = <span class="number">10</span></span><br><span class="line">    step = <span class="number">0.0001</span></span><br><span class="line">    gv.RBF_dlt = <span class="number">8</span></span><br><span class="line">    <span class="keyword">if</span> training == <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"traning model no:"</span>, i</span><br><span class="line">            SVM_SMO_train(T, <span class="number">100</span>, C, i, step)</span><br><span class="line">        save_models()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        load_models()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">            update_samples_label(i)</span><br><span class="line">    test()</span><br></pre></td></tr></table></figure>
<p>训练数据一共是1934个，测试数据是946，一共是识别出来了914个，其中有911个识别正确。运行结果的截图如下：</p>
<img src="/hexotech/images/blogimages/2012/svm-ocr/ocr_test_output.jpg" class="center">
<p>在实现的过程中，第一个版本效率很低，主要是做了两个地方的改进，一是，缓存了核函数的运算结果，二是，计算预测值的与真实值之差<span class="math inline">\(E\_i\)</span>，改用增量变化的方式，即每次只计算出<span class="math inline">\(new\\_a\_i\)</span>, <span class="math inline">\(new\\_a\_j\)</span>对<span class="math inline">\(E\_i\)</span>的改变量。 同样一开始，还有识别率低的问题，主要通过配置精度，惩罚系数，<span class="math inline">\(a\_i\)</span>改变最小步长，这三个参数来提高识别率。但还是对高斯核函数的径向基函数的宽度<span class="math inline">\(\delta\)</span>的调整最有效果，针对本例最优情况是当<span class="math inline">\(\delta=10\)</span>左右。</p>
<h2 id="不足">不足</h2>
<p>本文实现的例子，还有很多不足之处:</p>
<ol style="list-style-type: decimal">
<li>样本数据的偏移，训练时，正负样本的数量应该是相当的。本文中的例子，负样本是正样本的9倍。</li>
<li>高斯径向基函数的宽度，没有经过训练</li>
<li>选择第二个变量时，本文使用的是遍历方式，也可以改成寻找改变量最大的第二个参数，具体<a href="http://book.douban.com/subject/10590856/" target="_blank" rel="external">《统计学习方法》</a>的P129</li>
<li>核函数计算时，效率比较低，主要影响测试分类时的速度，如果能用到位运算，应该效率会高很多。</li>
</ol>
<p>其实上面的情况都还可以慢慢改进，最大的坑还是训练的时间太长了，我在虚拟机上装的ubuntu server运行的脚本，训练数据接近2000个，测试数据1000个，总共可能花了4个小时左右，时间太长。我之前的同事实现的ocr是居于online learing的，那么我们下一篇blog也来实现一个online learning的数字手写ocr，与今天这个对比一下。</p>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>主要参考了：<a href="http://www.blogjava.net/zhenandaci/archive/2009/03/26/262113.html" target="_blank" rel="external">SVM入门（十）将SVM用于多类分类</a>。<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>张翔，肖小玲，徐光祐，一种确定高斯核模型参数的新方法，计算机工程，第33卷，第12期，2007年6月。<a href="#fnref2">↩</a></p></li>
</ol>
</div>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liuhongjiang.github.io/hexotech/2012/12/29/svm-ocr/" data-id="cigkf990e002400i4c5xmlmcg" class="article-share-link">Share</a>
      
        <a href="http://liuhongjiang.github.io/hexotech/2012/12/29/svm-ocr/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/hexotech/2013/01/11/es/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          elasticsearch之基本操作
        
      </div>
    </a>
  
  
    <a href="/hexotech/2012/12/28/svm-smo/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">SMO序列最小最优化算法</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/3rd-nbsp-tools/">3rd&nbsp;tools</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/Algorithm/">Algorithm</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/C-C/">C/C++</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/Data-nbsp-structure/">Data&nbsp;structure</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/Fuck-nbsp-GFW/">Fuck&nbsp;GFW</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/Language/">Language</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/Machine-nbsp-Learning/">Machine&nbsp;Learning</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/Vi/">Vi</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/git/">git</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/hadoop/">hadoop</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/javascript/">javascript</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/linux/">linux</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/math/">math</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/octopress/">octopress</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/paper/">paper</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/python/">python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/hexotech/categories/sqlite/">sqlite</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2015/11/">November 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2015/10/">October 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2015/09/">September 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2015/08/">August 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2015/06/">June 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2015/05/">May 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2015/04/">April 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2014/05/">May 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2013/11/">November 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2013/08/">August 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2013/02/">February 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2013/01/">January 2013</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2012/12/">December 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/hexotech/archives/2012/11/">November 2012</a><span class="archive-list-count">7</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/hexotech/2015/11/04/editor-config/">EditorConfig</a>
          </li>
        
          <li>
            <a href="/hexotech/2015/10/14/alembic-support-multiple-model-files/">alembic support multiple model files</a>
          </li>
        
          <li>
            <a href="/hexotech/2015/10/14/install-ftp/">设置ftp匿名下载的服务</a>
          </li>
        
          <li>
            <a href="/hexotech/2015/09/30/vpn-server/">vpn server 搭建</a>
          </li>
        
          <li>
            <a href="/hexotech/2015/09/30/tmux/">tmux</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Andrew Liu<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/hexotech/" class="mobile-nav-link">Home</a>
  
    <a href="/hexotech/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'andrewliu117';
  
  var disqus_url = 'http://liuhongjiang.github.io/hexotech/2012/12/29/svm-ocr/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="/hexotech/js/jquery-2.1.4.min.js" type="text/javascript"></script>

<!--<script type="text/x-mathjax-config">-->
<!--MathJax.Hub.Config({-->
  <!--tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}-->
<!--});-->
<!--</script>-->
<!--<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">-->
<!--</script>-->


  <link rel="stylesheet" href="/hexotech/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/hexotech/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/hexotech/js/script.js" type="text/javascript"></script>


<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>